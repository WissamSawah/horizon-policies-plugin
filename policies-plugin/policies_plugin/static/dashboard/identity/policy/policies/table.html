<!-- Page header -->
<hz-page-header header="{$ 'Policies' | translate $}"></hz-page-header>


<!-- Table settings button -->
<div class="form-group">
    <div class="input-group">
        <input type="text" ng-model="searchText" uib-typeahead="item for item in table.items | filter:$viewValue | limitTo:8" class="form-control" placeholder="Search"/>
        <div class="btn-group pull-right" uib-dropdown is-open="status.isopen" auto-close="outsideClick">
            <button id="single-button" type="button" class="btn btn-default table-settings-button pull-right" uib-dropdown-toggle>
                <span class="fa fa-cog"></span> Table settings <span class="fa fa-caret-down"></span>
            </button>
            <!-- Settings button drop down menu-->
            <ul class="dropdown-menu" uib-dropdown-menu role="menu" aria-labelledby="single-button">
                <!-- Menu section title -->
                <li role="menuitem"><a>Show columns</a></li>
                <!-- Menu section divider -->
                <li class="divider"></li>
                <!-- Show/hide policy project column in policies table -->
                <li class="table-settings-menu-item" role="menuitem">
                    <input type="checkbox" ng-model="projectFilter" ng-checked="projectFilter" ng-init="projectFilter=true"/> Project
                </li>
                <!-- Show/hide policy target column in policies table -->
                <li class="table-settings-menu-item" role="menuitem">
                    <input type="checkbox" ng-model="targetFilter" ng-checked="targetFilter" ng-init="targetFilter=true"/> Target
                </li>
                <!-- Show/hide policy rule column in policies table -->
                <li class="table-settings-menu-item" role="menuitem">
                    <input type="checkbox" ng-model="ruleFilter" ng-checked="ruleFilter" ng-init="ruleFilter=true"/> Rule
                </li>
                <!-- Show/hide policy default rule column in policies table -->
                <li class="table-settings-menu-item" role="menuitem">
                    <input type="checkbox" ng-model="defaultFilter" ng-checked="defaultFilter" ng-init="defaultFilter=false"/> Default
                </li>
                <!-- Show/hide policy scopes column in policies table -->
                <li class="table-settings-menu-item" role="menuitem">
                    <input type="checkbox" ng-model="scopesFilter" ng-checked="scopesFilter" ng-init="scopesFilter=false"/> Scopes
                </li>
                <!-- Show/hide policy operations column in policies table -->
                <li class="table-settings-menu-item" role="menuitem">
                    <input type="checkbox" ng-model="operationsFilter" ng-checked="operationsFilter" ng-init="operationsFilter=false"/> Operations
                </li>
                <!-- Show/hide policy description column in policies table -->
                <li class="table-settings-menu-item" role="menuitem">
                    <input type="checkbox" ng-model="descriptionFilter" ng-checked="descriptionFilter" ng-init="descriptionFilter=true"/> Description
                </li>
            </ul>
        </div>
    </div>
</div>

<!-- Table -->
<table ng-controller="PoliciesController as table"
    hz-table ng-cloak
    st-table="table.items"
    st-safe-src="table.src"
    default-sort="name"
    default-sort-reverse="false"
    class="table table-striped table-rsp table-detail">

    <!-- Table headers -->
    <thead>
        <!-- Table headers row-->
        <tr>
            <!-- Checkbox column header -->
            <th class="multi_select_column">
                <input type="checkbox" hz-select-all="table.items">
            </th>
            <!-- Expander column header -->
            <th class="expander"></th>
            <!-- Project column header -->
            <th class="rsp-p1" st-sort="project" ng-show="projectFilter" translate>Project</th>
            <!-- Target column header -->
            <th class="rsp-p1" st-sort="target" ng-show="targetFilter" st-sort-default="target" translate>Target</th>
            <!-- Rule column header -->
            <th class="rsp-p1" st-sort="rule" ng-show="ruleFilter" translate>Rule</th>
            <!-- Default rule column header -->
            <th class="rsp-p1" st-sort="default" ng-show="defaultFilter" translate>Default</th>
            <!-- Scopes column header -->
            <th class="rsp-p1" st-sort="scopes" ng-show="scopesFilter" translate>Scopes</th>
            <!-- Operations column header -->
            <th class="rsp-p1" st-sort="operations" ng-show="operationsFilter" translate>Operations</th>
            <!-- Description column header -->
            <th class="rsp-p1" st-sort="description" ng-show="descriptionFilter" translate>Description</th>
        </tr>
    </thead>

    <!-- Table body -->
    <tbody>
        <!-- Table body rows -->
        <tr ng-repeat-start="item in table.items | filter:searchText track by item.target"
            ng-class="{'st-selected': checked[item.target]}">

            <!--  Checkbox column content -->
            <td class="multi_select_column">
                <input type="checkbox"
                        ng-model="table.selections[item.target].checked"
                        hz-select="item">
            </td>
            <!--  Expander column content -->
            <td class="expander" ng-click="expandSelected(item)">
                <span ng-if="!item.expanded"
                        class="fa fa-chevron-right"
                        duration="200">
                </span>
                <span ng-if="item.expanded"
                        class="fa fa-chevron-down"
                        duration="200">
                </span>
            </td>
            <!--  Project column content -->
            <td ng-show="projectFilter">
                <span ng-if="!item.expanded">
                    {$ item.project | limitTo:charLimit $}
                </span>
                <span ng-if="item.expanded">
                    {$ item.project $}
                </span>
            </td>
            <!--  Target column content -->
            <td ng-show="targetFilter">
                <span ng-if="!item.expanded">
                    {$ item.target | limitTo:charLimit $}
                </span>
                <span ng-if="item.expanded">
                    {$ item.target $}
                </span>
            </td>
            <!--  Rule column content -->
            <td ng-show="ruleFilter">
                <span ng-if="!item.expanded">
                    {$ item.rule | limitTo:charLimit $}
                </span>
                <span ng-if="item.expanded">
                    {$ item.rule $}
                </span>
            </td>
            <!--  Default rule column content -->
            <td ng-show="defaultFilter">
                <span ng-if="!item.expanded">
                    {$ item.default | limitTo:charLimit $}
                </span>
                <span ng-if="item.expanded">
                    {$ item.default $}
                </span>
            </td>
            <!--  Scopes column content -->
            <td ng-show="scopesFilter">
                <span ng-repeat="scope in item.scopes">
                    <span ng-if="!item.expanded">
                        {$ scope | limitTo:charLimit $}
                    </span>
                    <span ng-if="item.expanded">
                        {$ scope $}<br/>
                    </span>
                <span>
            </td>
            <!--  Operations column content -->
            <td ng-show="operationsFilter">
                <span ng-repeat="operation in item.operations | limitTo:item.listLimit">
                    <span ng-if="!item.expanded">
                        {$ operation | limitTo:charLimit $}
                    </span>
                    <span ng-if="item.expanded">
                        {$ operation $}<br/>
                    </span>
                <span>
            </td>
            <!--  Description column content -->
            <td ng-show="descriptionFilter">
                <span ng-if="!item.expanded">
                    {$ item.description | limitTo:charLimit $}
                </span>
                <span ng-if="item.expanded">
                    {$ item.description $}
                </span>
            </td>

        <tr ng-repeat-end class="detail-row">

        </tr>
    </tbody>
    <input type="button" id="goToTop" class="goToTop" value="Scroll Top" style="display:none;background-color:#f9f9f9"  />

    <!--  Table footer -->
    <tfoot hz-table-footer items="table.items"></tfoot>

</table>
<script>  $('.goToTop').click(function () {
    $("html, body").animate({ scrollTop: 0 }, 500);
    return false;
  });</script>
