<!-- Policies table controller -->
<div ng-controller="PoliciesController">

    <!-- Page header -->
    <hz-page-header header="{$ 'Policies' | translate $}"></hz-page-header>

    <div class="form-group">
        <div class="input-group">

            <!-- Search bar -->
            <input ng-model="query" id="query" class="form-control" placeholder="Search">

            <!-- Results per page drop down -->
            <select ng-model="pageSize" id="pageSize" class="form-control" ng-init="pageSize = '20'">
                <option value="10">10</option>
                <option value="20">20</option>
                <option value="50">50</option>
                <option value="100">100</option>
                <option value="200">200</option>
            </select>

            <!-- Table settings button group -->
            <div class="btn-group pull-right" uib-dropdown is-open="status.isopen" auto-close="outsideClick">

                <!-- Table settings button -->
                <button id="single-button" type="button" class="btn btn-default table-settings-button pull-right" uib-dropdown-toggle>
                    <span class="fa fa-cog"></span>
                    Table settings
                    <span class="fa fa-caret-down"></span>
                </button>

                <!-- Settings button drop down menu-->
                <ul class="dropdown-menu" uib-dropdown-menu role="menu" aria-labelledby="single-button">

                    <!-- Menu section title -->
                    <li role="menuitem"><a>Show columns</a></li>

                    <!-- Menu section divider -->
                    <li class="divider"></li>

                    <!-- Show/hide project column in policies table -->
                    <li class="table-settings-menu-item" role="menuitem">
                        <input type="checkbox" ng-model="projectFilter" ng-checked="projectFilter" ng-init="projectFilter=true"/> Project
                    </li>

                    <!-- Show/hide  target column in policies table -->
                    <li class="table-settings-menu-item" role="menuitem">
                        <input type="checkbox" ng-model="targetFilter" ng-checked="targetFilter" ng-init="targetFilter=true"/> Target
                    </li>

                    <!-- Show/hide rule column in policies table -->
                    <li class="table-settings-menu-item" role="menuitem">
                        <input type="checkbox" ng-model="ruleFilter" ng-checked="ruleFilter" ng-init="ruleFilter=true"/> Rule
                    </li>

                    <!-- Show/hide default rule column in policies table -->
                    <li class="table-settings-menu-item" role="menuitem">
                        <input type="checkbox" ng-model="defaultFilter" ng-checked="defaultFilter" ng-init="defaultFilter=false"/> Default
                    </li>

                    <!-- Show/hide scopes column in policies table -->
                    <li class="table-settings-menu-item" role="menuitem">
                        <input type="checkbox" ng-model="scopesFilter" ng-checked="scopesFilter" ng-init="scopesFilter=false"/> Scopes
                    </li>

                    <!-- Show/hide operations column in policies table -->
                    <li class="table-settings-menu-item" role="menuitem">
                        <input type="checkbox" ng-model="operationsFilter" ng-checked="operationsFilter" ng-init="operationsFilter=false"/> Operations
                    </li>

                    <!-- Show/hide description column in policies table -->
                    <li class="table-settings-menu-item" role="menuitem">
                        <input type="checkbox" ng-model="descriptionFilter" ng-checked="descriptionFilter" ng-init="descriptionFilter=true"/> Description
                    </li>

                </ul>
            </div>
        </div>
    </div>

    <!-- Table -->
    <table class="table table-striped table-rsp table-detail">
        <!-- Table headers -->
        <thead>
            <!-- Table headers row-->
            <tr>
                <!-- Checkbox column header -->
                <th class="multi_select_column">
                    <input type="checkbox">
                </th>

                <!-- Expander column header -->
                <th class="expander"></th>

                <!-- Project column header -->
                <th class="rsp-p1" ng-show="projectFilter" ng-click="sortColumn('project')" translate>Project
                    <span ng-show="column == 'project'">
                        <span ng-show="!reverse" class="fa fa-sort-down"></span>
                        <span ng-show="reverse" class="fa fa-sort-up"></span>
                    </span>
                </th>

                <!-- Target column header -->
                <th class="rsp-p1" ng-show="targetFilter" ng-click="sortColumn('target')" translate>Target
                    <span ng-show="column == 'target'">
                        <span ng-show="!reverse" class="fa fa-sort-down"></span>
                        <span ng-show="reverse" class="fa fa-sort-up"></span>
                    </span>
                </th>

                <!-- Rule column header -->
                <th class="rsp-p1" ng-show="ruleFilter" ng-click="sortColumn('rule')" translate>Rule
                    <span ng-show="column == 'rule'">
                        <span ng-show="!reverse" class="fa fa-sort-down"></span>
                        <span ng-show="reverse" class="fa fa-sort-up"></span>
                    </span>
                </th>

                <!-- Default rule column header -->
                <th class="rsp-p1" ng-show="defaultFilter" ng-click="sortColumn('default')" translate>Default
                    <span ng-show="column == 'default'">
                        <span ng-show="!reverse" class="fa fa-sort-down"></span>
                        <span ng-show="reverse" class="fa fa-sort-up"></span>
                    </span>
                </th>

                <!-- Scopes column header -->
                <th class="rsp-p1" ng-show="scopesFilter" ng-click="sortColumn('scopes')" translate>Scopes
                    <span ng-show="column == 'scopes'">
                        <span ng-show="!reverse" class="fa fa-sort-down"></span>
                        <span ng-show="reverse" class="fa fa-sort-up"></span>
                    </span>
                </th>

                <!-- Operations column header -->
                <th class="rsp-p1" ng-show="operationsFilter" ng-click="sortColumn('operations')" translate>Operations
                    <span ng-show="column == 'operations'">
                        <span ng-show="!reverse" class="fa fa-sort-down"></span>
                        <span ng-show="reverse" class="fa fa-sort-up"></span>
                    </span>
                </th>

                <!-- Description column header -->
                <th class="rsp-p1" ng-show="descriptionFilter" ng-click="sortColumn('description')" translate>Description
                    <span ng-show="column == 'description'">
                        <span ng-show="!reverse" class="fa fa-sort-down"></span>
                        <span ng-show="reverse" class="fa fa-sort-up"></span>
                    </span>
                </th>
            </tr>
        </thead>

        <!-- Table body -->
        <tbody>
            <!-- Table body rows -->
            <tr ng-repeat-start="item in data | orderBy:column:reverse |filter:query | limitTo:pageSize:currentPage*pageSize">

                <!--  Checkbox column content -->
                <td class="multi_select_column">
                    <input type="checkbox"
                            ng-model="table.selections[item.target].checked">
                </td>

                <!--  Expander column content -->
                <td class="expander" ng-click="expandSelected(item)">
                    <span ng-if="!item.expanded"
                            class="fa fa-chevron-right"
                            duration="200">
                    </span>
                    <span ng-if="item.expanded"
                            class="fa fa-chevron-down"
                            duration="200">
                    </span>
                </td>

                <!--  Project column content -->
                <td ng-show="projectFilter">
                    <span ng-if="!item.expanded">
                        {$ item.project | limitTo:charLimit $}
                    </span>
                    <span ng-if="item.expanded">
                        {$ item.project $}
                    </span>
                </td>

                <!--  Target column content -->
                <td ng-show="targetFilter" ng-click="getPolicy(item.target)">
                    <span ng-if="!item.expanded">
                        {$ item.target | limitTo:charLimit $}
                    </span>
                    <span ng-if="item.expanded">
                        {$ item.target $}
                    </span>
                </td>

                <!--  Rule column content -->
                <td ng-show="ruleFilter">
                    <span ng-if="!item.expanded">
                        {$ item.rule | limitTo:charLimit $}
                    </span>
                    <span ng-if="item.expanded">
                        {$ item.rule $}
                    </span>
                </td>

                <!--  Default rule column content -->
                <td ng-show="defaultFilter">
                    <span ng-if="!item.expanded">
                        {$ item.default | limitTo:charLimit $}
                    </span>
                    <span ng-if="item.expanded">
                        {$ item.default $}
                    </span>
                </td>

                <!--  Scopes column content -->
                <td ng-show="scopesFilter">
                    <span ng-repeat="scope in item.scopes">
                        <span ng-if="!item.expanded">
                            {$ scope | limitTo:charLimit $}
                        </span>
                        <span ng-if="item.expanded">
                            {$ scope $}<br/>
                        </span>
                    <span>
                </td>

                <!--  Operations column content -->
                <td ng-show="operationsFilter">
                    <span ng-repeat="operation in item.operations | limitTo:item.listLimit">
                        <span ng-if="!item.expanded">
                            {$ operation | limitTo:charLimit $}
                        </span>
                        <span ng-if="item.expanded">
                            {$ operation $}<br/>
                        </span>
                    <span>
                </td>

                <!--  Description column content -->
                <td ng-show="descriptionFilter">
                    <span ng-if="!item.expanded">
                        {$ item.description | limitTo:charLimit $}
                    </span>
                    <span ng-if="item.expanded">
                        {$ item.description $}
                    </span>
                </td>

            <tr ng-repeat-end></tr>
        </tbody>
    </table>

    <!--  Pagination -->
    <button ng-disabled="currentPage == 0"
            ng-click="currentPage=currentPage-1">
            Previous
    </button>
    {$ currentPage+1 $}/{$ numberOfPages() $}
    <button ng-disabled="currentPage >= data.length/pageSize - 1"
            ng-click="currentPage=currentPage+1">
            Next
    </button>

    <div>
        Policy: {$ policy $}
    </div>
    <div>
        Project: {$ policy.project $}
    </div>
    <div>
        Target: {$ policy.target $}
    </div>
    <div>
        Rule: {$ policy.rule $}
    </div>
    <div>
        Default: {$ policy.default $}
    </div>
    <div>
        Scopes: {$ policy.scopes $}
    </div>
    <div>
        Operations: {$ policy.operations $}
    </div>
    <div>
        Description: {$ policy.description $}
    </div>



</div>
